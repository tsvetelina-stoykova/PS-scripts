function deleteAlphaAndSpotChannels() {    function isAlphaOrSpotChannel() {        var ref = new ActionReference();        ref.putEnumerated(charIDToTypeID("Chnl"), charIDToTypeID("Ordn"), charIDToTypeID("Trgt"));        return executeActionGet(ref).hasKey(stringIDToTypeID('ID'));    }    function deleteChannelByIndex(idx) {        var desc = new ActionDescriptor();        var ref = new ActionReference();        ref.putIndex(charIDToTypeID("Chnl"), idx)        desc.putReference(charIDToTypeID("null"), ref);        executeAction(charIDToTypeID("Dlt "), desc, DialogModes.NO);    }    function getNumberOfChannels() {        var ref = new ActionReference();        ref.putEnumerated(charIDToTypeID("Dcmn"), charIDToTypeID("Ordn"), charIDToTypeID("Trgt"));        return executeActionGet(ref).getInteger(stringIDToTypeID('numberOfChannels'))// does not count layer masks      }    function numberOfComponentChannels() {        var ref = new ActionReference();        ref.putEnumerated(charIDToTypeID("Dcmn"), charIDToTypeID("Ordn"), charIDToTypeID("Trgt"));        var mode = typeIDToStringID(executeActionGet(ref).getEnumerationValue(stringIDToTypeID('mode')));        var numberOfComponentChannels = 4;// set default for CMYK          switch (mode) {            case "RGBColor":                numberOfComponentChannels = 3;                break;            case "labColor":                numberOfComponentChannels = 3;                break;            case "grayScale":                numberOfComponentChannels = 1;                break;        }        return numberOfComponentChannels;    }    while (getNumberOfChannels() > numberOfComponentChannels()) {        makeChannelActiveByIndex(getNumberOfChannels(), false);        if (isAlphaOrSpotChannel()) {            deleteChannelByIndex(getNumberOfChannels());        }    }    function makeChannelActiveByIndex(idx, visible) {        var desc = new ActionDescriptor();        var ref = new ActionReference();        ref.putIndex(charIDToTypeID("Chnl"), idx)        desc.putReference(charIDToTypeID("null"), ref);        desc.putBoolean(charIDToTypeID("MkVs"), visible);        executeAction(charIDToTypeID("slct"), desc, DialogModes.NO);    }}function main() {    if (!documents.length) return;//Reset Custom Options.  //app.eraseCustomOptions( 'a7ba92a0-d6f8-11df-937b-0800200c9a66' ); return;      try {        var Name = decodeURI(activeDocument.name).replace(/\.[^\.]+$/, '');        var Path = decodeURI(activeDocument.path);        var saveFile = File(Path + "/" + Name + ".JPG")        SaveJPEG(saveFile, 12);    } catch (e) {        alert(e + "\r@ Line " + e.line);    }}function SaveJPEG(saveFile, jpegQuality) {    var doc = activeDocument;    if (doc.bitsPerChannel != BitsPerChannelType.EIGHT) doc.bitsPerChannel = BitsPerChannelType.EIGHT;    jpgSaveOptions = new JPEGSaveOptions();    jpgSaveOptions.embedColorProfile = true;    jpgSaveOptions.formatOptions = FormatOptions.STANDARDBASELINE;    jpgSaveOptions.matte = MatteType.NONE;    jpgSaveOptions.quality = jpegQuality;    activeDocument.saveAs(saveFile, jpgSaveOptions, true, Extension.UPPERCASE);}deleteAlphaAndSpotChannels();  main();app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);  